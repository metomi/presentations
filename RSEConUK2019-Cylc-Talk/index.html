<!doctype html>
<html lang="en">

<head>
  <title>Pursuing & supporting reproducible workflows for all with Cylc</title>
  <meta
    name="description"
    content="Pursuing & supporting reproducible workflows for all with Cylc"
  />
  <meta
    name="author"
    content="Sadie Bartholomew & Oliver Sanders"
  />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=1024" />
  <link href="css/global-stylesheet.css" rel="stylesheet" />

  <script type="text/javascript" src="js/jquery.min.js"></script>
  <script type="text/javascript" src="js/index.js"></script>
  <script type="text/javascript" src="js/minicylc.js"></script>

  <!-- For OpenLayers map:-->
  <link rel="stylesheet" href="https://openlayers.org/en/v5.3.0/css/ol.css" type="text/css">
  <!-- (Grab scripts from source for now, but could consider bundling) -->
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>
  <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
</head>

<body class="impress-not-supported">

  <div class="fallback-message">
    <p>Something went wrong!</p>
  </div>

  <div id="impress">


    <!-- Title -->
    <div
      id="title-slide"
      class="step"
    >
      <p>
        Pursuing & supporting<br>
        <b>reproducible workflows</b><br>
        for <i>all</i> with<br>
          <img src="media/cylc-logo-white.svg"
          alt="cylc-logo-white" style="height:150px;">
      </p>
      <span
        style="
          font-size: 0.6em;
          color: rgb(100,100,100);
          "
      >
         Oliver Sanders & Sadie Bartholomew<br>
         (representing the Met Office)
      </span>
    </div>


    <!-- Setion 1 - Cylc 101 -->
    <div
      id="introduction-to-cylc"
      class="step"
      data-rel-y="1h"
      data-rel-to="title-slide"
    >
      <b>Introduction</b> to Cylc
    </div>

    <div
      class="step full vflex"
      data-rel-x="1.2w"
      data-rel-y="0"
    >
      <p>
        This is a <em>simple</em> workflow
      </p>
      <embed
        id="basic-workflow"
        class="flexgrow"
        src="media/graph/basic-workflow.svg"
      />
    </div>

    <div class="step full vflex">
      <p>
        This is a <em>repeating</em> workflow
      </p>
      <embed
        id="repeating-workflow"
        class="flexgrow"
        src="media/graph/repeating-workflow.svg"
      />
    </div>

    <div class="step full vflex">
      <p>
        This is a <em>Cylc cycling</em> workflow
      </p>
      <embed
        id="cycling-workflow"
        class="flexgrow"
        src="media/graph/cycling-workflow.svg"
      />
    </div>

    <div
      id="infinite-cycling"
      class="step full vflex"
    >
      <p>
        This is an <em>infinite cycling</em> workflow
      </p>
    </div>

    <script type=text/javascript>
      // write dependencies
      const deps = [];
      for (let i=0; i<100; i++) {
        deps.push(`a${i} => c${i} => d${i}`);
        deps.push(`a${i} => b${i}`);
        deps.push(`a${i} => a${i+1}`);
        deps.push(`c${i} => b${i+1}`);
      }

      // create graph
      const infininte_animation = $('<embed />')
        .addClass('minicylc flexgrow')
        .data('focus', true)
        .data('theme', 'demo')
        .data('randomFactor', 0.5)
        .data('dependencies', deps.join('//'))
        .attr('src', 'media/graph/infinite-workflow.svg')[0]
      $('#infinite-cycling').append(infininte_animation);

      infininte_animation.onload = function() {
        const infinite_workflow = new MiniCylc(infininte_animation);
        infinite_workflow.hold();
        infinite_workflow.run();

        // unhold when on slide
        addClassNameListener(
          $('#infinite-cycling')[0],
          'active',
          infinite_workflow.release.bind(infinite_workflow),
          infinite_workflow.hold.bind(infinite_workflow)
        );
      };
    </script>

    <div class="step">
      <p>
        Cylc provides a <em>moving window</em> on an infinite workflow
      </p>
      <br>
      <ul>
        <li>Workflows can be <em>infinite</em></li>
        <li>Complex workflows <em>scale</em></li>
        <li><em>Advanced cycling</em> is possible</li>
      </ul>
    </div>

    <div class="step full vflex" id="architecture">
      <embed
        class="flexgrow"
        src="media/system-diagram.svg"
      />
    </div>

    <div class="step">
      <p>Submit jobs with:</p>
      <ul style="
        position: relative;
        left: 100px;
        list-style: none;
        font-size: 0.8em;"
      >
        <br>
        <li>at</li>
        <li>background
          <span
            style="
              font-size: 0.6em;
              color: rgb(100,100,100);
            "
          >
            (no batch submission system)
          </span>
        </li>
        <li>loadleveler</li>
        <li>lsf</li>
        <li>moab</li>
        <li>pbs</li>
        <li>sge</li>
        <li>slurm</li>
      </ul>
    </div>

    <div class="step">
      <table class="iconlist">
        <tr>
          <td>
            <embed
              width="200em"
              src="media/icons/live.svg"
            />
          </td><td>
            <em>Live monitoring</em> via GUI or CLI
          </td>
        </tr><tr>
          <td>
            <embed
              width="200em"
              src="media/icons/hand.svg"
            />
          </td><td>
            <em>Manual intervention</em> with running workflows supported
          </td>
        </tr><tr>
          <td>
            <embed
              width="200em"
              src="media/icons/error.svg"
            />
          </td><td>
            <em>Automatically rerun</em> failed jobs
          </td>
        </tr>
      </table>
      </ul>
    </div>


    <!-- Section 2 - Cylc Usage -->
    <div
      id="usage-of-cylc"
      class="step"
      data-rel-y="1h"
      data-rel-to="introduction-to-cylc"
      >
      <b>Usage</b> & the Cylc <i>Community</i>
    </div>

    <div
      class="step"
      data-rel-x="1w"
      data-rel-y="0"
      >
      <em>International</em> use (& development)!<br>
       <b>Institutional</b> usage over 5 continents:
      <div id="map" class="map"></div>
       + <b>standalone</b> users
    </div>

    <div class="step">
    <h2 align="right">Example context: <em>NWP</em></h2>
    <div class="row">
      <div class="threecolumn">
        <br><br>
        <p><em>standard cycling</em><br> (cycle points are <i>labels</i>)</p>
      <embed
        id="cycling-workflow"
        class="flexgrow"
        src="media/graph/cycling-workflow.svg"
        height="400px"
      />
      </div>
      <div class="threecolumn central-col">
        <b>operations</b>
        <div id="curvedarrow"></div>
        <br>seamless<br> (w.r.t meta-scheduling)<br> "R2O" transition<br><br>
        <div id="curvedarrowrotate"></div>
        <b>research</b>
      </div>
      <div class="threecolumn">
        <br><br>
        <p><em>real-time cycling</em></p>
          <img src="media/clock-face.png" alt="clock-face"
          style="height:200px;position:absolute;top:300px;right:10px">
      <embed
        id="cycling-workflow"
        class="flexgrow"
        src="media/graph/cycling-workflow.svg"
        height="400px"
      />
      </div>
    </div>
    </div>

    <div class="step">
      <div class="grid-container">
        <div class="grid-item"></div>
        <div class="grid-item"></div>
        <div class="grid-item"></div>
        <div class="grid-item">
          provides the meta-scheduling for workload on
          <em>460,000 core HPC</em>
        </div>
        <div class="grid-item-central">
          <img src="media/metoffice-logo-black.png" alt="metoffice-logo-black"
          style="height:100px;">
          (largest Cylc-using site)
        </div>
        <div class="grid-item">demonstrated<br>
        <em>scaling to 10,000s of tasks</em>
        (with caveats)</div>
        <div class="grid-item"></div>
        <div class="grid-item">
        used in <em>both</em> research & operations</b>
        </div>
        <div class="grid-item"></div>
      </div>
    </div>

    <div class="step">
      <p align="right">Recent (research only) usage:</p>
          <img src="media/research-usage-graph.png" alt="research-usage-graph"
          style="height:600px;">
      <ul>
        <li>record of nearly 300 unique users</li>
        <li>a general upward trend</li>
      </ul>
    </div>

    <div class="step">
      <div class="grid-container">
        <div class="grid-item">
          fully <b>open-source</b>, via
          <img src="media/github-logo.png" alt="github-logo"
          style="height:75px;align:right"><br>
          <a href="https://github.com/cylc">cylc organisation</a>
          (<i>GPLv3</i> license)
        </div>
        <div class="grid-item">
            <img src="media/python-logo.png" alt="python-logo"
              style="height:150px;">
        <b>Python-powered</b> core scheduling code (with an otherwise
        changing tech stack)
        </div>
        <div class="grid-item"></div>
        <div class="grid-item"></div>
        <div class="grid-item-central">Development:<br>
          ecosystem & history</div>
        <div class="grid-item"></div>
        <div class="grid-item"></div>
        <div class="grid-item">
          &gt;10 years of development!
          <img src="media/github-commit-history.png"
          alt="github-commit-history" style="height:150px;">
          (shown are <i>git</i> code commits)
        </div>
        <div class="grid-item"></div>
      </div>
    </div>

    <div class="step">
      <h1>Workflow <b>design choices</b> include:</h1>
      <br>
      <ul font-size="0.6em">
        <li>
          <b>single monolithic</b> workflow <i>or</i> <b>multiple
          modular</b> ones (connected via inter-workflow triggering)
        </li>
        <li><b>task granularity</b>: fine <i>or</i> coarse</li>
        <li>
          <b>task generation</b>: in-built parameterisation <i>or</i> templating
        </li>
        <li><b>task inheritance</b>: <i>structure</i></li>
      </ul>
    </div>

    <div class="step">
      <div class="grid-container">
        <div class="grid-item">
          issue tracking & links to documentation & website etc.<br> via
          <a href="https://github.com/cylc">cylc</a> on<br>
          <img src="media/github-octocat.png" alt="github-octocat"
          style="height:100px;">
          <img src="media/github-logo.png" alt="github-logo"
          style="height:75px;">

        </div>
        <div class="grid-item"></div>
        <div class="grid-item">
          (for individuals<br>
          from selected<br>
          <a href="https://www.esiwace.eu/services/support/overview">
          eligible</a> institutions)
          formal support via
          <img src="media/esiwace-logo.png" alt="esiwace-logo"
          style="height:75px;">
          (who part-fund the Cylc project)
        </div>
        <div class="grid-item"></div>
        <div class="grid-item-central">
          Support available
        </div>
        <div class="grid-item"></div>
        <div class="grid-item"></div>
        <div class="grid-item">
          dedicated support<br> & discussion<br>
          <img src="media/discourse-logo.png" alt="discourse-logo"
          style="height:75px;">
          <br><a href="https://cylc.discourse.group/">forum</a>
        </div>
        <div class="grid-item"></div>
      </div>
    </div>


    <!-- Section 3 - Cylc Future -->
    <div
      id="future-cylc"
      class="step"
      data-rel-y="1h"
      data-rel-to="usage-of-cylc"
      >
      The <b>Future</b> of Cylc
    </div>

    <div
      class="step"
      data-rel-x="1w"
      data-rel-y="0"
      >
      <p>Same<br><i>concept</i>,<br>with a<br>revised<br><i>tech</i><br>
      <i>stack</i></p>
      <div class="split left">
        <div class="centered">
          <p>Cylc-<b>7</b>:
          <div class="container">
            <img src="media/python-logo.png" alt="python-logo"
              style="height:175px;">
            <div class="centered-cont">2</div>
          </div>
          <img src="media/cherrypy-logo.png" alt="cherrypy-logo"
            style="height:125px;">
          <img src="media/rest-logo.png" alt="rest-logo"
            style="height:125px;">
          <img src="media/gtk-logo.png" alt="gtk-logo"
            style="height:200px;">
          <img src="media/latex-logo.png" alt="latex-logo"
            style="height:100px;">
          </p>
        </div>
      </div>
      <div class="split right">
        <div class="centered">
          <p>Cylc-<b>8</b>:
          <div class="container">
            <img src="media/python-logo.png" alt="python-logo"
              style="height:175px;">
            <div class="centered-cont">3</div>
          </div>
          <img src="media/tornado-logo.png" alt="tornado-logo"
            style="height:75px;">
          <img src="media/graphql-logo.png" alt="graphql-logo"
            style="height:175px;">
          <img src="media/zmq-logo.png" alt="zmq-logo"
            style="height:150px;">
          <img src="media/css3-and-html5-logos.png" alt="css-html-logos"
            style="height:125px;"> <img src="media/vue-logo.png" alt="vue-logo"
            style="height:150px;">
          <img src="media/sphinx-logo.png" alt="sphinx-logo"
            style="height:75px;">
          </p>
        </div>
      </div>
    </div>

    <div class="step">
      <b>Integrated</b> browser-based
      <a href="https://github.com/cylc/cylc-ui/files/3362486/design.document.pdf">design</a>...
      <img src="media/cylc-8-mockup.png" alt="cylc-8-mockup"
        style="height:550px;">
      <b>Improved UX</b> after user feedback
    </div>

    <div class="step">
      <ul>
        <li><b>Cylc-8.0.0 "coming soon"</b> (<i>optimistic</i> estimate for
          release ~May 2020)
        </li>
        <br>
        <li><b>Until then, please use Cylc 7.8.<i>X</i></b>, e.g. the latest,
          <a href="https://github.com/cylc/cylc-flow/releases/tag/7.8.3">
          7.8<i>.3</i></a>, which is thoroughly tested & supported
        </li>
        <br>
        <li>Install for Linux
          <a href="https://github.com/cylc/cylc-flow/blob/7.8.x/INSTALL.md">
          via GitHub</a>
        </li>
      </ul>
    </div>


    <!-- Closing Slides -->
    <div
      id="fin"
      class="step"
      data-rel-y="1h"
      data-rel-to="future-cylc"
    >
      Thanks for listening!<br>
      We welcome your questions.
      <img src="media/cylc-logo-colour.svg" alt="cylc-logo-colour"
        style="height:350px;">
      <p align="right"><em>... for reproducible workflows</em></p>
    </div>


  </div>

  <!-- impress.js related: -->
  <div id="impress-toolbar"></div>
  <script src="js/impress.js"></script>
  <script>impress().init();</script>

  <!-- OpenLayers map related: -->
  <script type="text/javascript">

    var cylcUsingInstitutionCoors = {
      "Met Office": [50.727622, -3.475646],
      "Centre for Environmental Data Analysis (CEDA)": [51.574887, -1.314517],
      "Plymouth Marine Laboratory": [50.366158, -4.147829],
      "National Centre for Atmospheric Science (NCAS)": [53.804501, -1.561474],
      "National Institute of Water & Atmospheric Research (NIWA)": [-36.8731, 174.7773],
      "Max-Planck-Institut für Meteorologie": [53.5677276, 9.9752491],
      "Deutches Klimarechenzentrum (DKRZ)": [53.5668648, 9.9765854],
      "Bureau of Meteorology": [-37.819662735644165, 144.9508629712867],
      "Meteorological Service Singapore (MSS)": [1.3538045, 103.9887531],
      "NRL Marine Meteorology Division": [36.59290173643106, -121.85459554195404],
      "Geophysical Fluid Dynamics Laboratory (GFDL)": [40.34539934495465, -74.61623311042786],
      "Phillippine Atmospheric, Geophysical, & Astronomical Services Administration (PAGASA)": [14.641788980309357, 121.04441821575165],
      "South African Weather Service (SAWS)": [-25.8906835142836, 28.17072629928589],
      "National Centre for Medium Range Weather Forecasting (NCMRWF)": [28.6244782, 77.3591772],
      "Korean Meteorological Administration (KMA)": [37.494, 126.917],
      "Centre of Excellence in Simulation of Weather and Climate in Europe (ESiWACE)": [53.5668648, 9.9765854],
      "NOAA Center for Weather and Climate Prediction (NCWCP)": [38.972, -76.925],
      "Euro-Mediterranean Center on Climate Change (CMCC)": [40.3522584, 18.1716594],
      "Barcelona Supercomputing Center (BSC)": [41.389, 2.116],
      "National Center for Atmospheric Reserach (NCAR)": [39.9778899, -105.2748664],
      "ARC Centre of Excellence for Climate Extremes (CLEX)": [-33.918, 151.234],
      "Netherlands eScience Center": [52.356907918929025, 4.9544088542461395],
      "557th Weather Wing": [41.1303357, -95.9153233]
    };

    var map = new ol.Map({
      target: 'map',
      layers: [
        new ol.layer.Tile({
          source: new ol.source.OSM()
        })
      ],
      view: new ol.View({
        center: ol.proj.fromLonLat([0, 30].reverse()),
        zoom: 2
      })
    });

    var markersList = [];
    for (var institution in cylcUsingInstitutionCoors) {
      // needs 'reverse' as OpenLayers is in LonLat not more standard LatLon
      var markerData = cylcUsingInstitutionCoors[institution].reverse();
      var markerAll = new ol.Feature({
        geometry: new ol.geom.Point(
        ol.proj.fromLonLat(markerData)
        ),
      });
      markersList.push(markerAll);
    }
    var vectorSource = new ol.source.Vector({
      features: markersList
    });

    var markerVectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: new ol.style.Style({
        image: new ol.style.Circle({
          radius: 7,
          fill: new ol.style.Fill({color: 'black'}),
          stroke: new ol.style.Stroke({
            color: [255, 255, 255], width: 2
          })
        })
      })
    });
    map.addLayer(markerVectorLayer);
  </script>

</body>
</html>
